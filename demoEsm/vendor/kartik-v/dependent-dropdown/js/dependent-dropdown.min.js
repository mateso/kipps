/*!
 * @copyright &copy; Kartik Visweswaran, Krajee.com, 2013 - 2015
 * @version 1.4.3
 *
 * A multi level dependent dropdown JQuery plugin. The plugin
 * allows nested and combined dependencies.
 * 
 * For more JQuery plugins visit http://plugins.krajee.com
 * For more Yii related demos visit http://demos.krajee.com
 */!function(e){"use strict";var t=function(t,a){return null===t||void 0===t||0===t.length||a&&""===e.trim(t)},a=function(t,a,n,d,i){var o={value:a,text:n};i=i||{},o=e.extend(o,i),null!==d&&d.length&&a.toString()===d&&(o.selected="selected"),e("<option/>",o).appendTo(t)},n=function(e,t){var a,n,d,i={};if(0===e.length)return{};for(a=0;a<e.length;a++)n=e[a],d=t[a],i[n]=d;return i},d=function(t,a){var n=this;n.$element=e(t),e.each(a,function(e,t){n[e]=t}),n.initData(),n.init()};d.prototype={constructor:d,initData:function(){var e=this,t=e.$element;e.initVal=t.val(),t.data("url",e.url).data("depends",e.depends).data("placeholder",e.placeholder).data("loading",e.loading).data("loadingClass",e.loadingClass).data("loadingText",e.loadingText).data("emptyMsg",e.emptyMsg).data("initialize",e.initialize).data("params",e.params)},init:function(){var a,n=this,d=n.depends,i=n.$element,o=d.length,r=i.find("option").length,l=n.initDepends||n.depends;(0===r||i.find('option[value=""]').length===r)&&i.attr("disabled","disabled");for(var p=0;o>p;p++)a=e("#"+d[p]),a.on("depdrop.change change select2:select krajeeselect2:cleared",function(e){(t(a.data("select2"))||"change"!==e.type)&&n.setDep(a,d,o)});if(n.initialize===!0)for(var p=0;p<l.length;p++)e("#"+l[p]).trigger("depdrop.change");i.trigger("depdrop.init")},setDep:function(t,a,n){for(var d,i,o=this,r=o.$element,l={},p=0;n>p;p++)d=e("#"+a[p]),i=d.attr("type"),l[p]="checkbox"===i||"radio"===i?d.prop("checked"):d.val();o.processDep(r,t.attr("id"),l,a)},processDep:function(d,i,o,r){var l,p,s,c,g,u=this,f=0,h={},m={depdrop_parents:o},v=n(r,o),y={},b=d.data("url"),x=d.data("placeholder"),C=d.data("loading"),D=d.data("loadingClass"),T=d.data("loadingText"),V=d.data("emptyMsg"),j=d.data("params");if(!t(j)){for(s=0;s<j.length;s++)c=j[s],g=e("#"+j[s]).val(),h[s]=g,y[c]=g;m={depdrop_parents:o,depdrop_params:h}}m.depdrop_all_params=e.extend(v,y),p={url:b,type:"post",data:m,dataType:"json",beforeSend:function(){d.trigger("depdrop.beforeChange",[i,e("#"+i).val(),u.initVal]),d.find("option[selected]").removeAttr("selected"),d.val("").attr("disabled","disabled").html(""),C&&d.removeClass(D).addClass(D).html('<option id="">'+T+"</option>")},success:function(n){l=t(n.selected)?u.initVal===!1?null:u.initVal:n.selected,t(n)?a(d,"",V,""):(d.html(u.getSelect(n.output,x,l)),d.find("optgroup").length>0&&d.find('option[value=""]').attr("disabled","disabled"),n.output&&d.removeAttr("disabled")),f=d.find("option").length,d.find('option[value=""]').length>0&&(f-=1),d.trigger("depdrop.change",[i,e("#"+i).val(),f,u.initVal])},error:function(){d.trigger("depdrop.error",[i,e("#"+i).val(),u.initVal])},complete:function(){C&&d.removeClass(D),d.trigger("depdrop.afterChange",[i,e("#"+i).val(),u.initVal])}},e.ajax(p)},getSelect:function(n,d,i){var o,r=this,l=e("<select>"),p=r.idParam,s=r.nameParam;return d!==!1&&a(l,"",d,i),t(n)&&(n={}),e.each(n,function(t,n){if(n[p])o=n.options||{},a(l,n[p],n[s],i,o);else{var d=e("<optgroup>",{label:t});e.each(n,function(e,t){o=t.options||{},a(d,t[p],t[s],i)}),d.appendTo(l)}}),l.html()}},e.fn.depdrop=function(t){var a=Array.apply(null,arguments);return a.shift(),this.each(function(){var n=e(this),i=n.data("depdrop"),o="object"==typeof t&&t;i||(i=new d(this,e.extend({},e.fn.depdrop.defaults,o,e(this).data())),n.data("depdrop",i)),"string"==typeof t&&i[t].apply(i,a)})},e.fn.depdrop.defaults={url:"",loading:!0,loadingClass:"kv-loading",loadingText:"Loading ...",placeholder:"Select ...",emptyMsg:"No data found",initialize:!1,idParam:"id",nameParam:"name",params:{}},e.fn.depdrop.Constructor=d,e(function(){e("select.depdrop").depdrop()})}(window.jQuery);